<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test SeatOptions Correction</title>
  <link rel="stylesheet" href="./global.css">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>

<body>
  <div class="container">
    <h1>Test SeatOptions and AccessoriesGroup Correction</h1>

    <form id="testForm">
      <!-- Test Seat Options -->
      <div class="form-group">
        <label>Seat Options</label>
        <div class="checkbox-grid">
          <div class="checkbox-item">
            <input type="radio" id="seatOption1" name="seatOptions" value="Suede 01 Turquoise Green">
            <label for="seatOption1">Suede 01 Turquoise Green</label>
          </div>
          <div class="checkbox-item">
            <input type="radio" id="seatOption2" name="seatOptions" value="Suede 02 Turquoise Blue">
            <label for="seatOption2">Suede 02 Turquoise Blue</label>
          </div>
          <div class="checkbox-item">
            <input type="radio" id="seatOption3" name="seatOptions" value="Suede 03 Royal Blue" checked>
            <label for="seatOption3">Suede 03 Royal Blue</label>
          </div>
          <div class="checkbox-item">
            <input type="radio" id="seatOption4" name="seatOptions" value="Suede 04 Purple">
            <label for="seatOption4">Suede 04 Purple</label>
          </div>
        </div>
      </div>

      <!-- Test Accessories Group -->
      <div class="form-group">
        <label>Accessories Group</label>
        <div class="checkbox-grid">
          <div class="checkbox-item">
            <input type="radio" id="accessory1" name="accessoriesGroup" value="Hoof Pick Holder on Latego">
            <label for="accessory1">Hoof Pick Holder on Latego</label>
          </div>
          <div class="checkbox-item">
            <input type="radio" id="accessory2" name="accessoriesGroup" value="Hoof Pick Holder on Skirt" checked>
            <label for="accessory2">Hoof Pick Holder on Skirt</label>
          </div>
          <div class="checkbox-item">
            <input type="radio" id="accessory3" name="accessoriesGroup" value="Rig Guard">
            <label for="accessory3">Rig Guard</label>
          </div>
          <div class="checkbox-item">
            <input type="radio" id="accessory4" name="accessoriesGroup" value="Saddle String 4 or 6">
            <label for="accessory4">Saddle String 4 or 6</label>
          </div>
        </div>
      </div>

      <button type="button" id="testValues">Test Corrected Values</button>
    </form>

    <div id="results" style="margin-top: 20px; padding: 20px; background: #f0f0f0; border-radius: 5px;"></div>
  </div>

  <script>
    // Simulate the methods from PDFGenerator
    function getCheckedRadioValue(fieldName) {
      const $field = $('#testForm').find(`[name="${fieldName}"]:checked`);
      return $field.length ? $field.val() : '';
    }

    function getOptionTranslation(fieldName, optionValue) {
      // Simulate translation - in real app this would use TranslationManager
      const translations = {
        'seatOptions': {
          'Suede 01 Turquoise Green': 'Camurça 01 Verde Turquesa',
          'Suede 02 Turquoise Blue': 'Camurça 02 Azul Turquesa',
          'Suede 03 Royal Blue': 'Camurça 03 Azul Real',
          'Suede 04 Purple': 'Camurça 04 Roxo'
        },
        'accessoriesGroup': {
          'Hoof Pick Holder on Latego': 'Suporte para Limpador de Casco no Latego',
          'Hoof Pick Holder on Skirt': 'Suporte para Limpador de Casco na Saia',
          'Rig Guard': 'Protetor de Rigging',
          'Saddle String 4 or 6': 'Cordas da Sela 4 ou 6'
        }
      };
      return translations[fieldName] && translations[fieldName][optionValue]
        ? translations[fieldName][optionValue]
        : optionValue;
    }

    function getNumberedRadioValue(fieldName) {
      const $field = $('#testForm').find(`[name="${fieldName}"]:checked`);
      if ($field.length) {
        const allFields = $('#testForm').find(`[name="${fieldName}"]`);
        const checkedIndex = allFields.index($field) + 1; // Start from 1
        const formattedIndex = checkedIndex.toString().padStart(2, '0'); // Format as 01, 02, etc.
        const originalValue = $field.val();
        const translatedValue = getOptionTranslation(fieldName, originalValue);
        return `${formattedIndex} - ${translatedValue}`;
      }
      return '';
    }

    function getCheckedValues(fieldName) {
      const values = [];
      $('#testForm').find(`[name="${fieldName}"]:checked`).each(function () {
        const originalValue = $(this).val();
        const translatedValue = getOptionTranslation(fieldName, originalValue);
        values.push(translatedValue);
      });
      return values;
    }

    $('#testValues').on('click', function () {
      const results = {
        'seatOptions (OLD - getCheckedValues)': getCheckedValues('seatOptions').join(', '),
        'seatOptions (NEW - getNumberedRadioValue)': getNumberedRadioValue('seatOptions'),
        'accessoriesGroup (OLD - getCheckedValues)': getCheckedValues('accessoriesGroup').join(', '),
        'accessoriesGroup (NEW - getNumberedRadioValue)': getNumberedRadioValue('accessoriesGroup')
      };

      let html = '<h3>Test Results - Before and After Correction:</h3>';

      for (const [key, value] of Object.entries(results)) {
        const isNew = key.includes('NEW');
        const hasNumber = value.match(/^\d{2} - /);
        const color = isNew && hasNumber ? 'green' : isNew ? 'red' : 'orange';
        html += `<p style="color: ${color}"><strong>${key}:</strong> "${value}"</p>`;
      }

      html += '<br><p><strong>Expected:</strong></p>';
      html += '<p style="color: green;">✓ NEW methods should return: "03 - Camurça 03 Azul Real" and "02 - Suporte para Limpador de Casco na Saia"</p>';
      html += '<p style="color: orange;">⚠ OLD methods return: "Camurça 03 Azul Real" and "Suporte para Limpador de Casco na Saia" (without numbers)</p>';

      $('#results').html(html);
    });
  </script>
</body>

</html>